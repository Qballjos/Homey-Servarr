<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Control Center</title><script src="/lib/homey.js"></script><style>body{margin:0;padding:15px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:0 0;color:#2c3e50}.widget-container{text-align:center}.header{margin-bottom:20px}.count{font-size:36px;font-weight:700;color:#2c3e50;margin:5px 0}.label{font-size:12px;color:#7f8c8d;text-transform:uppercase;letter-spacing:1px}.actions{display:flex;gap:10px;justify-content:center;margin-bottom:15px}.btn{flex:1;padding:12px;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;text-transform:uppercase}.btn-pause{background:#e74c3c;color:#fff}.btn-resume{background:#27ae60;color:#fff}.btn:active{transform:scale(.95)}.btn:disabled{opacity:.5;cursor:not-allowed}.app-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:15px;padding:10px;background:rgba(0,0,0,.03);border-radius:8px}.app-btn{padding:8px 4px;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;background:#fff;color:#34495e;border:1px solid #ddd}.app-btn:hover{background:#f8f9fa}.queue-list{list-style:none;padding:0;margin:15px 0;text-align:left}.queue-item{display:flex;align-items:center;gap:8px;padding:8px 0;border-bottom:1px solid #eee;font-size:13px}.dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.title{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.status{font-size:11px;color:#7f8c8d}.color-radarr{background:#ffc107}.color-sonarr{background:#00aaff}.color-lidarr{background:#4caf50}.color-prowlarr{background:#9c27b0}</style></head><body><div class="widget-container"><div class="header"><div class="label">Total Queue</div><div class="count" id="total-count">0</div></div><div class="actions"><button class="btn btn-pause" id="pause-all">Pause All</button> <button class="btn btn-resume" id="resume-all">Resume All</button></div><div class="app-grid"><button class="app-btn" onclick="refreshApp('radarr')">Radarr</button> <button class="app-btn" onclick="refreshApp('sonarr')">Sonarr</button> <button class="app-btn" onclick="refreshApp('lidarr')">Lidarr</button> <button class="app-btn" onclick="refreshApp('prowlarr')">Prowlarr</button></div><ul class="queue-list" id="queue-list"></ul></div><script>Homey.ready();const countEl=document.getElementById("total-count"),listEl=document.getElementById("queue-list");async function load(){try{const result = await Homey.api("GET", "/widgets/queue");if(result){const{queueItems:e}=result;countEl.textContent=e?e.length:0,listEl.innerHTML="",e&&e.slice(0,5).forEach(e=>{const t=document.createElement("li");t.className="queue-item",t.innerHTML=`<div class="dot color-${e.app}"></div><div class="title">${e.title}</div><div class="status">${e.status}</div>`,listEl.appendChild(t)}),e&&e.length>5?(()=> {const t=document.createElement("div");t.style.fontSize="11px",t.style.color="#7f8c8d",t.style.marginTop="5px",t.textContent=`+ ${e.length-5} more items...`,listEl.appendChild(t)})():(!e||0===e.length)&&(listEl.innerHTML='<li style="text-align:center;color:#7f8c8d;font-size:12px;">Queue is empty</li>')}}catch(e){console.error("Error loading queue:",e)}}async function refreshApp(e){try{await Homey.api("POST", "/widgets/queue/refresh", {app:e}),Homey.showNotification(`Refreshed ${e}`),load()}catch(e){Homey.alert(e.message)}}document.getElementById("pause-all").onclick=async()=>{try{await Homey.api("POST", "/widgets/queue/pause"),Homey.showNotification("All downloads paused"),load()}catch(e){Homey.alert(e.message)}},document.getElementById("resume-all").onclick=async()=>{try{await Homey.api("POST", "/widgets/queue/resume"),Homey.showNotification("All downloads resumed"),load()}catch(e){Homey.alert(e.message)}},Homey.on("capability:measure_queue_count",()=>load()),load(),setInterval(load,6e4);</script></body></html>
